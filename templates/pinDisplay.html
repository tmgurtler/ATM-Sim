<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta content="width=300, initial-scale=1" name="viewport">
        
        <title>NYIT ATM</title>

        <link rel="stylesheet" type="text/css" href="/style/main.css">
    </head>

    <body onload="timer()">
        <div class="wrapper">
            <div class="main content clearfix">
                <div class="banner">
                    <h1>
                        Your PIN is <b id="typeToContinue" style="font-family:monospace;"></b>
                    </h1>
                </div>
                
                <div class="google-footer-bar">
                    This webpage collects user data for a scientific experiment by NYIT, UIUC, RIT, and BMC.

                    By participating in the experiment and interacting with this webpage, you agree that information about the timing with which you pressed the keys of your keyboard will be collected. No other personal information is gathered. Data is securely and anonymously collected on a secure database. <br><br>
                    NEVER TYPE YOUR REAL PINs HERE! INPUT ONLY THE PIN GIVEN TO PERFORM THE EXPERIMENT!
                </div>
            </div>
        </div>

        <form id="sender" method="POST" action="/experiment/{{ userString }}">
            <input type="hidden" name="setNumber" value="{{ setNumber }}">
            <input type="hidden" name="orderString" value="{{ orderString }}">
            <input type="hidden" name="holdString" value="{{ holdString }}">
            <input type="hidden" name="numThruSet" value="{{ numThruSet }}">
            <input type="hidden" name="numThruPin" value="{{ numThruPin }}">
        </form>

        <script>
            pinsets = [
                [1256, 9854, 0759, 3575, 1793, 9713, 4069, 9274, 1973, 3791, 2002, 0220, 1032, 3012, 9999],
                [7854, 6589, 1570, 0953, 2871, 4697, 7614, 3496, 3719, 9173, 2075, 5902, 8103, 8301, 1111],
                [2589, 9632, 2685, 8425, 5005, 7997, 3843, 1861, 9137, 7319, 4209, 7026, 1039, 3013, 5555]
            ];

            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            async function timer() {
                await sleep(4000);
                form = document.getElementById("sender");
                form.submit();
            }

            var setNumber = {{ setNumber }}; 
            var orderString = "{{ orderString }}";
            var specificPIN = orderString.charCodeAt(0) - "a".charCodeAt(0);

            document.getElementById("typeToContinue").innerHTML = ("0000" + (pinsets[setNumber][specificPIN]).toString()).slice(-4);
        </script>
    </body>
</html>